# File cordova_plugins.js - Cordova Plugin Registry

## ğŸ“˜ cordova_plugins.js lÃ  gÃ¬?

**cordova_plugins.js** lÃ  file **auto-generated** (tá»± Ä‘á»™ng táº¡o) bá»Ÿi Cordova, chá»©a **registry** (danh sÃ¡ch) táº¥t cáº£ Cordova plugins Ä‘Æ°á»£c cÃ i Ä‘áº·t trong app.

---

## ğŸ¯ DÃ¹ng Ä‘á»ƒ lÃ m gÃ¬?

### **1. Plugin loader vÃ  registry:**

```javascript
cordova.define("cordova/plugin_list", function (require, exports, module) {
  // âœ… Array of all installed plugins
  module.exports = [
    {
      id: "cordova-plugin-camera.camera",
      file: "plugins/cordova-plugin-camera/www/Camera.js",
      pluginId: "cordova-plugin-camera",
      clobbers: ["navigator.camera"], // â† Makes available as navigator.camera
    },
    {
      id: "cordova-plugin-file-transfer.FileTransfer",
      file: "plugins/cordova-plugin-file-transfer/www/FileTransfer.js",
      pluginId: "cordova-plugin-file-transfer",
      clobbers: ["window.FileTransfer"], // â† Makes available as window.FileTransfer
    },
    // ... 50+ more plugins
  ];

  // âœ… Plugin versions metadata
  module.exports.metadata = {
    "cordova-plugin-camera": "4.0.3",
    "cordova-plugin-file-transfer": "1.7.1",
    // ... versions for all plugins
  };
});
```

---

## ğŸ“Š Plugin entry structure:

### **Each plugin has:**

```javascript
{
  "id": "cordova-plugin-camera.camera",           // âœ… Unique plugin ID
  "file": "plugins/cordova-plugin-camera/www/Camera.js",  // âœ… JavaScript file path
  "pluginId": "cordova-plugin-camera",            // âœ… Plugin package name
  "clobbers": ["navigator.camera"]                // âœ… Global namespace
}
```

---

### **What "clobbers" means:**

```javascript
// Plugin definition:
"clobbers": ["navigator.camera"]

// Result: Creates global object
navigator.camera = {
  getPicture: function() { ... },
  cleanup: function() { ... }
};

// Now you can use it in your code:
navigator.camera.getPicture(success, error, options);
```

---

### **What "merges" means:**

```javascript
// Plugin definition:
"merges": ["window"]

// Result: Adds properties to existing object (doesn't replace)
window.existingProperty = "kept";
window.newPluginProperty = "added";  // â† Plugin adds this
```

---

### **What "runs" means:**

```javascript
// Plugin definition:
"runs": true

// Result: Plugin code runs immediately on load (no global object)
// Used for utility plugins that don't need a public API
```

---

## ğŸ”„ How it works:

### **When app starts:**

```
1. cordova.js loads
   â†“
2. cordova.js reads cordova_plugins.js
   â†“
3. For each plugin in the array:
   - Load plugin file (e.g., Camera.js)
   - Attach to global namespace (e.g., navigator.camera)
   â†“
4. Plugins are now available in your code
   âœ… navigator.camera.getPicture()
   âœ… window.FileTransfer
   âœ… cordova.plugins.printer
```

---

## ğŸ¯ Khi nÃ o dÃ¹ng?

### **1. Automatically loaded on app start:**

```javascript
// When Cordova app starts:
document.addEventListener(
  "deviceready",
  function () {
    // âœ… At this point, cordova_plugins.js has loaded
    // âœ… All plugins are available

    // Now you can use plugins:
    navigator.camera.getPicture(success, error);

    window.FileTransfer.download(url, target, success, error);

    cordova.plugins.printer.print(content);
  },
  false
);
```

---

### **2. Generated by Cordova commands:**

```bash
# When you add a plugin
cordova plugin add cordova-plugin-camera
# âœ… Updates cordova_plugins.js

# When you build
cordova build android
# âœ… Regenerates cordova_plugins.js

# When you prepare
cordova prepare
# âœ… Updates cordova_plugins.js
```

---

## ğŸ“Š Your app's installed plugins:

### **From cordova_plugins.js:**

```javascript
// Core plugins:
âœ… cordova-plugin-camera          (v4.0.3)   - Take photos
âœ… cordova-plugin-file            (v6.0.2)   - File system access
âœ… cordova-plugin-file-transfer   (v1.7.1)   - Download/upload files
âœ… cordova-plugin-printer         (v0.8.0)   - Print documents
âœ… cordova-plugin-device          (v1.1.2)   - Device info

// Firebase & Auth:
âœ… cordova-plugin-firebase-lib    (v5.1.1)   - Firebase integration
âœ… cordova-plugin-googleplus      (v7.0.2)   - Google Sign-In
âœ… cordova-plugin-touch-id        (v3.3.1)   - Touch ID / Face ID

// Security:
âœ… cordova-plugin-jailbreak-detection (v0.1.0) - Detect jailbreak/root
âœ… cordova-plugin-secure-storage-echo (v5.1.1) - Encrypted storage

// Updates:
âœ… cordova-plugin-code-push       (v1.12.0)  - Over-the-air updates

// Payment:
âœ… cordova.plugin.cardconnect     (v0.7.0)   - Card reader integration

// Media:
âœ… cordova-plugin-media           (v5.0.4)   - Audio recording/playback
âœ… cordova-plugin-inappbrowser    (v4.1.0)   - In-app browser

// Utilities:
âœ… cordova-plugin-dialogs         (v2.0.2)   - Native dialogs
âœ… cordova-plugin-network-information (v1.3.2) - Network status
âœ… cordova-plugin-insomnia        (v4.3.0)   - Prevent screen sleep
âœ… cordova.plugins.diagnostic     (v5.0.0)   - Check permissions
âœ… cordova-plugin-splashscreen    (v4.0.3)   - Splash screen
âœ… cordova-plugin-whitelist       (v1.2.2)   - Security whitelist
```

---

## ğŸš¨ Important notes:

### **1. âŒ Never edit manually:**

```javascript
// âŒ DON'T DO THIS:
// Manually add plugin to cordova_plugins.js

// âœ… DO THIS:
cordova plugin add cordova-plugin-camera
// Let Cordova update cordova_plugins.js
```

---

### **2. âœ… Auto-generated file:**

```
Generated by:
- cordova plugin add/remove
- cordova prepare
- cordova build

Location:
- app/cordova_plugins.js (web version)
- platforms/android/.../www/cordova_plugins.js (Android build)
- platforms/ios/.../www/cordova_plugins.js (iOS build)
```

---

### **3. ğŸ”„ Regenerated on build:**

```bash
# Each build regenerates this file
cordova build android

# Result:
# cordova_plugins.js is updated
# Old one is overwritten
```

---

## ğŸ” Plugin usage examples:

### **Example 1: Camera plugin**

```javascript
// Plugin entry in cordova_plugins.js:
{
  "id": "cordova-plugin-camera.camera",
  "clobbers": ["navigator.camera"]
}

// Usage in your code:
navigator.camera.getPicture(
  function(imageData) {
    // âœ… Success
    var image = document.getElementById('myImage');
    image.src = "data:image/jpeg;base64," + imageData;
  },
  function(error) {
    // âŒ Error
    console.error('Camera error:', error);
  },
  {
    quality: 50,
    destinationType: Camera.DestinationType.DATA_URL
  }
);
```

---

### **Example 2: File Transfer plugin**

```javascript
// Plugin entry in cordova_plugins.js:
{
  "id": "cordova-plugin-file-transfer.FileTransfer",
  "clobbers": ["window.FileTransfer"]
}

// Usage in your code:
var fileTransfer = new FileTransfer();
var uri = encodeURI("http://example.com/file.pdf");
var fileURL = cordova.file.dataDirectory + "file.pdf";

fileTransfer.download(
  uri,
  fileURL,
  function(entry) {
    // âœ… Success
    console.log("Download complete: " + entry.toURL());
  },
  function(error) {
    // âŒ Error
    console.error("Download error:", error.code);
  },
  false,
  {}
);
```

---

### **Example 3: Printer plugin**

```javascript
// Plugin entry in cordova_plugins.js:
{
  "id": "cordova-plugin-printer.Printer",
  "clobbers": ["cordova.plugins.printer"]
}

// Usage in your code (from your treamentNoteATP.js):
$scope.printPDF = function(data){
  getFilePDFTreatmentNote(data._id, 'PRINT_PDF').then(function(dataResponse){
    if (isApp && isAndroid) {
      // âœ… Uses plugin from cordova_plugins.js
      cordova.plugins.printer.print(dataResponse);
    }
  });
};
```

---

## ğŸ“Š File locations:

```
Project structure:
Client/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ cordova_plugins.js           âœ… Web version (for testing)
â”œâ”€â”€ platforms/
â”‚   â”œâ”€â”€ android/
â”‚   â”‚   â””â”€â”€ app/src/main/assets/www/
â”‚   â”‚       â””â”€â”€ cordova_plugins.js   âœ… Android build version
â”‚   â””â”€â”€ ios/
â”‚       â””â”€â”€ www/
â”‚           â””â”€â”€ cordova_plugins.js   âœ… iOS build version
â””â”€â”€ plugins/                         âœ… Plugin source files
    â”œâ”€â”€ cordova-plugin-camera/
    â”œâ”€â”€ cordova-plugin-file/
    â””â”€â”€ ...
```

---

## ğŸ” Check installed plugins:

### **Method 1: Read cordova_plugins.js**

```javascript
// Open: app/cordova_plugins.js
// Count entries in module.exports array
// 50+ plugins installed
```

---

### **Method 2: Cordova CLI**

```bash
# List all installed plugins
cordova plugin list

# Output:
cordova-plugin-camera 4.0.3 "Camera"
cordova-plugin-file 6.0.2 "File"
cordova-plugin-file-transfer 1.7.1 "File Transfer"
cordova-plugin-printer 0.8.0 "Printer"
# ... etc
```

---

### **Method 3: Check at runtime**

```javascript
document.addEventListener(
  "deviceready",
  function () {
    // Check if plugin is available
    if (navigator.camera) {
      console.log("âœ… Camera plugin loaded");
    }

    if (window.FileTransfer) {
      console.log("âœ… File Transfer plugin loaded");
    }

    if (cordova.plugins.printer) {
      console.log("âœ… Printer plugin loaded");
    }
  },
  false
);
```

---

## ğŸ“Š Summary:

| Question                      | Answer                                                            |
| ----------------------------- | ----------------------------------------------------------------- |
| **cordova_plugins.js lÃ  gÃ¬?** | Auto-generated registry of all Cordova plugins                    |
| **DÃ¹ng Ä‘á»ƒ lÃ m gÃ¬?**           | Load and register plugins, make them available globally           |
| **Khi nÃ o dÃ¹ng?**             | Automatically loaded when app starts (deviceready event)          |
| **CÃ³ thá»ƒ edit khÃ´ng?**        | âŒ NO - Auto-generated, will be overwritten                       |
| **Khi nÃ o regenerate?**       | Every `cordova prepare`, `cordova build`, plugin add/remove       |
| **CÃ³ commit lÃªn Git?**        | âš ï¸ Optional - Usually in `.gitignore` (regenerated from plugins/) |

---

## âœ… Best practices:

```bash
# âœ… Add plugins via CLI
cordova plugin add cordova-plugin-camera

# âœ… Let Cordova manage cordova_plugins.js
# Don't edit manually

# âœ… Use plugins after deviceready
document.addEventListener('deviceready', function() {
  navigator.camera.getPicture(...);
});

# âœ… Check plugin availability
if (navigator.camera) {
  // Plugin loaded
}
```

---

**cordova_plugins.js is the auto-generated "phone book" that tells Cordova where to find all your plugins and how to load them!**
